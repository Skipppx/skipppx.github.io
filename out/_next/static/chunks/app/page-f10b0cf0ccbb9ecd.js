(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{3570:(e,t,r)=>{Promise.resolve().then(r.bind(r,3757))},3757:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>m});var a=r(6384),o=function(e){return e[e.INNER_1=0]="INNER_1",e[e.TRP_1=1]="TRP_1",e[e.OUTER_1=2]="OUTER_1",e[e.DBL_1=3]="DBL_1",e[e.INNER_2=4]="INNER_2",e[e.TRP_2=5]="TRP_2",e[e.OUTER_2=6]="OUTER_2",e[e.DBL_2=7]="DBL_2",e[e.INNER_3=8]="INNER_3",e[e.TRP_3=9]="TRP_3",e[e.OUTER_3=10]="OUTER_3",e[e.DBL_3=11]="DBL_3",e[e.INNER_4=12]="INNER_4",e[e.TRP_4=13]="TRP_4",e[e.OUTER_4=14]="OUTER_4",e[e.DBL_4=15]="DBL_4",e[e.INNER_5=16]="INNER_5",e[e.TRP_5=17]="TRP_5",e[e.OUTER_5=18]="OUTER_5",e[e.DBL_5=19]="DBL_5",e[e.INNER_6=20]="INNER_6",e[e.TRP_6=21]="TRP_6",e[e.OUTER_6=22]="OUTER_6",e[e.DBL_6=23]="DBL_6",e[e.INNER_7=24]="INNER_7",e[e.TRP_7=25]="TRP_7",e[e.OUTER_7=26]="OUTER_7",e[e.DBL_7=27]="DBL_7",e[e.INNER_8=28]="INNER_8",e[e.TRP_8=29]="TRP_8",e[e.OUTER_8=30]="OUTER_8",e[e.DBL_8=31]="DBL_8",e[e.INNER_9=32]="INNER_9",e[e.TRP_9=33]="TRP_9",e[e.OUTER_9=34]="OUTER_9",e[e.DBL_9=35]="DBL_9",e[e.INNER_10=36]="INNER_10",e[e.TRP_10=37]="TRP_10",e[e.OUTER_10=38]="OUTER_10",e[e.DBL_10=39]="DBL_10",e[e.INNER_11=40]="INNER_11",e[e.TRP_11=41]="TRP_11",e[e.OUTER_11=42]="OUTER_11",e[e.DBL_11=43]="DBL_11",e[e.INNER_12=44]="INNER_12",e[e.TRP_12=45]="TRP_12",e[e.OUTER_12=46]="OUTER_12",e[e.DBL_12=47]="DBL_12",e[e.INNER_13=48]="INNER_13",e[e.TRP_13=49]="TRP_13",e[e.OUTER_13=50]="OUTER_13",e[e.DBL_13=51]="DBL_13",e[e.INNER_14=52]="INNER_14",e[e.TRP_14=53]="TRP_14",e[e.OUTER_14=54]="OUTER_14",e[e.DBL_14=55]="DBL_14",e[e.INNER_15=56]="INNER_15",e[e.TRP_15=57]="TRP_15",e[e.OUTER_15=58]="OUTER_15",e[e.DBL_15=59]="DBL_15",e[e.INNER_16=60]="INNER_16",e[e.TRP_16=61]="TRP_16",e[e.OUTER_16=62]="OUTER_16",e[e.DBL_16=63]="DBL_16",e[e.INNER_17=64]="INNER_17",e[e.TRP_17=65]="TRP_17",e[e.OUTER_17=66]="OUTER_17",e[e.DBL_17=67]="DBL_17",e[e.INNER_18=68]="INNER_18",e[e.TRP_18=69]="TRP_18",e[e.OUTER_18=70]="OUTER_18",e[e.DBL_18=71]="DBL_18",e[e.INNER_19=72]="INNER_19",e[e.TRP_19=73]="TRP_19",e[e.OUTER_19=74]="OUTER_19",e[e.DBL_19=75]="DBL_19",e[e.INNER_20=76]="INNER_20",e[e.TRP_20=77]="TRP_20",e[e.OUTER_20=78]="OUTER_20",e[e.DBL_20=79]="DBL_20",e[e.BULL=80]="BULL",e[e.DBL_BULL=81]="DBL_BULL",e[e.MISS=82]="MISS",e[e.BUST=83]="BUST",e[e.RESET_BUTTON=84]="RESET_BUTTON",e}({});let n=(e,t)=>{switch(e){case 1:break;case 2:return t?"D":"Double";case 3:return t?"T":"Triple"}return""},_=e=>{if(e<80){let t=4;switch(e%4){case 1:t=3;break;case 3:t=2;break;default:t=1}let r=Math.ceil((e+1)/4),a=r*t,o=n(t,!1)+" "+r,_=n(t,!0)+r;return console.log(e,t,r,a,o,_),{ID:e,Type:t,Section:r,Value:a,LongName:o,ShortName:_}}switch(e){case 80:case 81:let t=80===e?1:2,r=n(t,!1)+" Bullseye",a=n(t,!0)+"BULL";return{ID:e,Type:t,Section:25,Value:80===e?25:50,LongName:r,ShortName:a};case 84:return{ID:e,Type:4,Section:26,Value:0,LongName:"Reset Button",ShortName:"RST"};case 83:return{ID:e,Type:4,Section:26,Value:0,LongName:"Bust",ShortName:"Bust"};default:return{ID:e,Type:4,Section:26,Value:0,LongName:"Miss",ShortName:"Miss"}}};var i=r(6636),l=r(2841),s=r.n(l),c=r(3275),R=r.n(c),d=r(6754).hp;let T="442f1570-8a00-9a28-cbe1-e1d4212d53eb",E=1,N=0,u={"50-46-51-64":o.INNER_1,"50-46-52-64":o.TRP_1,"50-46-53-64":o.OUTER_1,"50-46-54-64":o.DBL_1,"57-46-49-64":o.INNER_2,"57-46-48-64":o.TRP_2,"57-46-50-64":o.OUTER_2,"56-46-50-64":o.DBL_2,"55-46-49-64":o.INNER_3,"55-46-48-64":o.TRP_3,"55-46-50-64":o.OUTER_3,"56-46-52-64":o.DBL_3,"48-46-49-64":o.INNER_4,"48-46-51-64":o.TRP_4,"48-46-53-64":o.OUTER_4,"48-46-54-64":o.DBL_4,"53-46-49-64":o.INNER_5,"53-46-50-64":o.TRP_5,"53-46-52-64":o.OUTER_5,"52-46-54-64":o.DBL_5,"49-46-48-64":o.INNER_6,"49-46-49-64":o.TRP_6,"49-46-51-64":o.OUTER_6,"52-46-52-64":o.DBL_6,"49-49-46-49-64":o.INNER_7,"49-49-46-50-64":o.TRP_7,"49-49-46-52-64":o.OUTER_7,"56-46-54-64":o.DBL_7,"54-46-50-64":o.INNER_8,"54-46-52-64":o.TRP_8,"54-46-53-64":o.OUTER_8,"54-46-54-64":o.DBL_8,"57-46-51-64":o.INNER_9,"57-46-52-64":o.TRP_9,"57-46-53-64":o.OUTER_9,"57-46-54-64":o.DBL_9,"50-46-48-64":o.INNER_10,"50-46-49-64":o.TRP_10,"50-46-50-64":o.OUTER_10,"52-46-51-64":o.DBL_10,"55-46-51-64":o.INNER_11,"55-46-52-64":o.TRP_11,"55-46-53-64":o.OUTER_11,"55-46-54-64":o.DBL_11,"53-46-48-64":o.INNER_12,"53-46-51-64":o.TRP_12,"53-46-53-64":o.OUTER_12,"53-46-54-64":o.DBL_12,"48-46-48-64":o.INNER_13,"48-46-50-64":o.TRP_13,"48-46-52-64":o.OUTER_13,"52-46-53-64":o.DBL_13,"49-48-46-51-64":o.INNER_14,"49-48-46-52-64":o.TRP_14,"49-48-46-53-64":o.OUTER_14,"49-48-46-54-64":o.DBL_14,"51-46-48-64":o.INNER_15,"51-46-49-64":o.TRP_15,"51-46-50-64":o.OUTER_15,"52-46-50-64":o.DBL_15,"49-49-46-48-64":o.INNER_16,"49-49-46-51-64":o.TRP_16,"49-49-46-53-64":o.OUTER_16,"49-49-46-54-64":o.DBL_16,"49-48-46-49-64":o.INNER_17,"49-48-46-48-64":o.TRP_17,"49-48-46-50-64":o.OUTER_17,"56-46-51-64":o.DBL_17,"49-46-50-64":o.INNER_18,"49-46-52-64":o.TRP_18,"49-46-53-64":o.OUTER_18,"49-46-54-64":o.DBL_18,"54-46-49-64":o.INNER_19,"54-46-48-64":o.TRP_19,"54-46-51-64":o.OUTER_19,"56-46-53-64":o.DBL_19,"51-46-51-64":o.INNER_20,"51-46-52-64":o.TRP_20,"51-46-53-64":o.OUTER_20,"51-46-54-64":o.DBL_20,"56-46-48-64":o.BULL,"52-46-48-64":o.DBL_BULL,"66-84-78-64":o.RESET_BUTTON,"79-85-84-64":o.MISS},h=async e=>{try{let t=await e.xlsx.writeBuffer(),r=d.from(t).toString("base64"),a=await fetch("/api/save-leaderboard",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({workbookData:r})});if(!a.ok)throw Error("Failed to save file: ".concat(a.statusText));console.log("File saved successfully on the server.")}catch(e){console.error("Error saving file to server:",e)}},g=(e,t)=>{new(s()).Workbook().xlsx.load(e).then(async e=>{e.eachSheet(e=>{e.addRow(t),console.log("addrow")})}).catch(e=>{console.error("Error reading Excel file:",e)})},f=async e=>{try{let t=await fetch("data/leaderboard.xlsx");if(!t.ok)throw Error("Failed to fetch file: ".concat(t.statusText));let r=await t.arrayBuffer();g(r,e)}catch(e){console.error("Error loading file:",e)}(0,i.useEffect)(()=>{f(e)},[])};class y{static async ConnectToBoard(){let e=await navigator.bluetooth.requestDevice({filters:[{services:[T]}]});if(await navigator.bluetooth,console.log("BLUETOOTH "+JSON.stringify(navigator.bluetooth)),!e||!e.gatt)throw Error("This PC's bluetooth could not find the board. Please make sure the board is connected.");e.gatt.connected||await e.gatt.connect();let t=await e.gatt.getPrimaryService(T),r=(await t.getCharacteristics()).find(e=>e.properties.notify);if(!r)throw Error("This PC's bluetooth could not find the board. Please make sure the board is connected.");let a=new y(r);return e.gatt.connect(),await r.startNotifications(),console.log(e.gatt.getPrimaryService(T)),a}async onSegmentHit(){if(E<7){if(!this.bluetoothConnection.value)return;let r=u[new Uint8Array(this.bluetoothConnection.value.buffer).join("-")];if(void 0!==r){r.toString(),null==(e=this.segmentHitCallback)||e.call(this,_(r)),E+=1;var e,t=_(r).Value;N+=t;let a=document.querySelector("dialog"),o=document.querySelector("#nameInput"),n=document.querySelector("#emailInput"),i=o?o.value:"",l=n?n.value:"";if(a?(a.querySelector("#nameSpan").textContent="Name: "+i,a.querySelector("#hitSpan").textContent="Last Hit: "+t,a.querySelector("#scoreSpan").textContent="Current Total Score: "+N,a.querySelector("#dartsSpan").textContent="Darts Remaining: "+(7-E),a.show()):console.log("Dialog element not found."),E>6){R().fire({title:"Out of Darts, "+i+"!",text:"Your score was: "+N+". \n\nThis has been added to the leaderboard. Want to play again?",icon:"warning",showConfirmButton:!0,showCancelButton:!0,confirmButtonText:"Yes",cancelButtonText:"No"}).then(e=>{e.isConfirmed||location.reload()}),f([i,l,N,new Date().toLocaleDateString("en-GB")]);let e=await fetch("data/leaderboard.xlsx");if(!e.ok)throw Error("Failed to fetch file: ".concat(e.statusText));let t=await e.arrayBuffer();new(s()).Workbook().xlsx.load(t).then(async e=>{e.eachSheet(t=>{var r=!1,a=!1,o=!1,n=!1;t.eachRow((e,t)=>{e.eachCell((e,t)=>{1===t&&e.value===i&&(r=!0,console.log("NAME EXISTS")),2===t&&e.value===l&&(a=!0,console.log("EMAIL EXISTS")),3===t&&e.value===N&&(o=!0,console.log("SCORE EXISTS")),4===t&&e.value===new Date().toLocaleDateString("en-GB")&&(n=!0,console.log("DATE EXISTS"))})}),r&&a&&o&&n||(t.addRow([i,l,N,new Date().toLocaleDateString("en-GB")]),h(e)),N=0,E=1})}).catch(e=>{console.error("Error reading Excel file:",e)})}}}else R().fire({title:"Out of Darts!",text:"Want to play again?",icon:"warning",showDenyButton:!0,showConfirmButton:!0,confirmButtonText:"Yes",denyButtonText:"No"}).then(e=>{e.isConfirmed||e.isDenied&&location.reload()}),E=1,N=0}constructor(e){this.bluetoothConnection=e,this.bluetoothConnection.addEventListener("characteristicvaluechanged",this.onSegmentHit.bind(this))}}var B=r(1685),b=r.n(B);r(5215);let L=e=>{new(s()).Workbook().xlsx.load(e).then(e=>{e.eachSheet((e,t)=>{e.eachRow((e,t)=>{})})}).catch(e=>{console.error("Error reading Excel file:",e)})};function m(){let[e,t]=(0,i.useState)(),[r,o]=(0,i.useState)("Click Here To Connect"),n=async()=>{o("Connecting...");try{t(await y.ConnectToBoard()),o("Connected"),console.log(y)}catch(e){console.error(e),o("Error - please click to retry.")}},_=async()=>{try{let e=await fetch("data/leaderboard.xlsx");if(!e.ok)throw Error("Failed to fetch file: ".concat(e.statusText));let t=await e.arrayBuffer();L(t)}catch(e){console.error("Error loading file:",e)}},l=(0,i.useRef)(null);return(0,i.useEffect)(()=>{let e=l.current;if(!e)return;let t=e.getContext("2d");if(t){console.log("loaded");for(let e=0;e<20;e++){let r=.05*Math.PI+.1*e*Math.PI,a=r+.1*Math.PI,o="#ffb914",n="#ff9100";t.strokeStyle="#000000",t.fillStyle=e%2==0?o:n,t.beginPath(),t.moveTo(250,250),t.arc(250,250,240,r,a,!1),t.closePath(),t.fill(),t.stroke(),t.strokeStyle="#000000",t.fillStyle=e%2==0?"#000000":"#FFFFFF",t.beginPath(),t.moveTo(250,250),t.arc(250,250,220,r,a,!1),t.closePath(),t.fill(),t.stroke(),t.strokeStyle="#000000",t.fillStyle=e%2==0?o:n,t.beginPath(),t.moveTo(250,250),t.arc(250,250,140,r,a,!1),t.closePath(),t.fill(),t.stroke(),t.strokeStyle="#000000",t.fillStyle=e%2==0?"#000000":"#FFFFFF",t.beginPath(),t.moveTo(250,250),t.arc(250,250,120,r,a,!1),t.closePath(),t.fill(),t.stroke(),t.strokeStyle="#000000",t.fillStyle=o,t.beginPath(),t.arc(250,250,30,0,2*Math.PI,!1),t.fill(),t.stroke(),t.strokeStyle="#000000",t.fillStyle="#e62236",t.beginPath(),t.arc(250,250,10,0,2*Math.PI,!1),t.fill(),t.stroke()}}},[]),(0,i.useEffect)(()=>{_()},[]),(0,a.jsxs)("main",{children:[(0,a.jsxs)("dialog",{style:{position:"absolute",top:0,right:0,marginRight:"1em",marginTop:"1em",padding:"1em",border:"none",backgroundColor:"transparent",color:"black",fontSize:"1.8em",textAlign:"right",fontFamily:"monospace"},children:[(0,a.jsx)("span",{className:"animate__animated animate__bounce",id:"nameSpan",children:"Name: "}),(0,a.jsx)("br",{}),(0,a.jsx)("span",{className:"animate__animated animate__bounce",id:"hitSpan",children:"Last Hit: "}),(0,a.jsx)("br",{}),(0,a.jsx)("span",{className:"animate__animated animate__bounce",id:"scoreSpan",children:"Current Total Score: "}),(0,a.jsx)("br",{}),(0,a.jsx)("span",{className:"animate__animated animate__bounce",id:"dartsSpan",children:"Remaining Darts: "})]}),(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsxs)("div",{className:"inputsDiv flex flex-row",children:[(0,a.jsx)("input",{id:"nameInput",type:"text",className:"text-gray-900 bg-white border border-gray-300 focus:outline-none hover:bg-gray-100 focus:ring-4 focus:ring-gray-200 font-medium rounded-lg text-sm px-5 py-2.5 dark:bg-gray-800 dark:text-white dark:border-gray-600 dark:hover:bg-gray-700 dark:hover:border-gray-600 dark:focus:ring-gray-700",placeholder:"Enter your name to start."}),(0,a.jsx)("input",{id:"emailInput",type:"text",className:"text-gray-900 bg-white border border-gray-300 focus:outline-none hover:bg-gray-100 focus:ring-4 focus:ring-gray-200 font-medium rounded-lg text-sm px-5 py-2.5 dark:bg-gray-800 dark:text-white dark:border-gray-600 dark:hover:bg-gray-700 dark:hover:border-gray-600 dark:focus:ring-gray-700",placeholder:"Enter your email (optional)."})]}),(0,a.jsx)("canvas",{className:"canvasdb",ref:l,width:500,height:500}),(0,a.jsx)("div",{className:"items-center",children:(0,a.jsx)("button",{className:"connectButton text-gray-900 bg-white border border-gray-300 focus:outline-none hover:bg-gray-100 focus:ring-4 focus:ring-gray-200 font-medium rounded-lg text-sm px-5 py-2.5 dark:bg-gray-800 dark:text-white dark:border-gray-600 dark:hover:bg-gray-700 dark:hover:border-gray-600 dark:focus:ring-gray-700",onClick:n,children:r})}),(0,a.jsx)(b(),{href:"/leaderboard",className:"text-gray-900 bg-white border border-gray-300 focus:outline-none hover:bg-gray-100 focus:ring-4 focus:ring-gray-200 font-medium rounded-lg text-sm px-5 py-2.5 dark:bg-gray-800 dark:text-white dark:border-gray-600 dark:hover:bg-gray-700 dark:hover:border-gray-600 dark:focus:ring-gray-700",children:"Click here for Leaderboard"})]})]})}},5215:()=>{}},e=>{var t=t=>e(e.s=t);e.O(0,[844,325,985,454,309,951,358],()=>t(3570)),_N_E=e.O()}]);