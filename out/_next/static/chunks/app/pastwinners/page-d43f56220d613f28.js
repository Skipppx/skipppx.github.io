(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[869],{201:(e,r,t)=>{Promise.resolve().then(t.bind(t,8982))},5215:()=>{},8982:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>c});var a=t(6384),l=t(6636),o=t(1685),n=t.n(o),s=t(2841),i=t.n(s);t(5215);var d=t(6754).hp;function c(){var e="<table>";let r=async e=>{try{let r=await e.xlsx.writeBuffer(),t=d.from(r).toString("base64"),a=await fetch("/api/save-pastwinners",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({workbookData:t})});if(!a.ok)throw Error("Failed to save file: ".concat(a.statusText));console.log("File saved successfully on the server.")}catch(e){console.error("Error saving file to server:",e)}},t=t=>{new(i()).Workbook().xlsx.load(t).then(async t=>{document.querySelector("table")||t.eachSheet(a=>{a.getSheetValues().slice(2).sort((e,r)=>{var t,a;return(null!=(t=r[4])?t:0)-(null!=(a=e[4])?a:0)}),!function(e,r){let t=!(arguments.length>2)||void 0===arguments[2]||arguments[2],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,l=arguments.length>4?arguments[4]:void 0;l=l||e.actualRowCount,r--;let o=[];for(let r=a;r<=(null!=l?l:e.actualRowCount);r++){let t=[];for(let a=1;a<=e.columnCount;a++)t.push(e.getRow(r).getCell(a).value);o.push(t)}o.sort((e,a)=>{var l,o,n,s;return e[r]===a[r]?0:t?(null!=(l=e[r])?l:0)>(null!=(o=a[r])?o:0)&&t?-1:1:(null!=(n=e[r])?n:0)<(null!=(s=a[r])?s:0)?-1:1}),e.spliceRows(a,l,...o)}(a,4,!0,2,a.rowCount),r(t),a.eachRow((r,t)=>{console.log("row values "+r.values),1===t?r.eachCell((r,t)=>{e+="<th>".concat(r.value,"</th>")}):(e+="<tr>",r.eachCell((r,a)=>{if(4===a){let t=JSON.stringify(r.value).split("T")[0].split('"')[1].split("-"),l=t[2]+"-"+t[1]+"-"+t[0];e+="<td id='date"+a+"'>".concat(l,"</td>")}else if(2===a)e+="<td id='score"+a+"'>".concat(r.value,"</td>");else if(3===a)if("object"==typeof r.value&&null!==r.value)for(let[a,l]of Object.entries(r.value))"text"===a&&(l.richText[0].text?e+="<td id='email"+t+"'>".concat(l.richText[0].text,"</td>"):e+="<td id='email"+t+"'>N/A</td>");else"string"==typeof r.value&&null!==r.value?e+="<td id='email"+t+"'>".concat(r.value,"</td>"):e+="<td id='email"+t+"'>N/A</td>";else e+="<td id='name"+a+"'>".concat(r.value,"</td>")})),e+="</tr>"});var l=document.getElementById("tableLeaderboard");l&&(l.innerHTML=e+"</table>")})}).catch(e=>{console.error("Error reading Excel file:",e)})},o=async()=>{try{let e=await fetch("data/pastwinners.xlsx");if(!e.ok)throw Error("Failed to fetch file: ".concat(e.statusText));let r=await e.arrayBuffer();t(r)}catch(e){console.error("Error loading file:",e)}};return(0,l.useEffect)(()=>{o()},[]),(0,a.jsxs)("main",{className:"flex min-h-screen flex-col items-start gap-4 px-24 py-10",children:[(0,a.jsx)("div",{className:"w-full h-20 text-white font-medium rounded-lg text-4xl px-5 py-2.5 text-left",children:"Past Winners"}),(0,a.jsx)("div",{id:"tableLeaderboard"}),(0,a.jsxs)("div",{className:"grid grid-cols-2",children:[(0,a.jsx)(n(),{href:"/",className:"text-gray-900 bg-white border border-gray-300 focus:outline-none hover:bg-gray-100 focus:ring-4 focus:ring-gray-200 font-medium rounded-lg text-sm px-5 py-2.5 dark:bg-gray-800 dark:text-white dark:border-gray-600 dark:hover:bg-gray-700 dark:hover:border-gray-600 dark:focus:ring-gray-700",children:"Home"}),(0,a.jsx)(n(),{href:"/leaderboard",className:"text-gray-900 bg-white border border-gray-300 focus:outline-none hover:bg-gray-100 focus:ring-4 focus:ring-gray-200 font-medium rounded-lg text-sm px-5 py-2.5 dark:bg-gray-800 dark:text-white dark:border-gray-600 dark:hover:bg-gray-700 dark:hover:border-gray-600 dark:focus:ring-gray-700",children:"This Week's Leaderboard"})]})]})}}},e=>{var r=r=>e(e.s=r);e.O(0,[844,325,454,309,951,358],()=>r(201)),_N_E=e.O()}]);