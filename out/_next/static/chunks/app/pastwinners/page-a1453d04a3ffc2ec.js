(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[869],{489:()=>{},1002:(e,t,l)=>{"use strict";l.r(t),l.d(t,{default:()=>i});var a=l(5155),o=l(2115),r=l(6575),n=l.n(r);l(489);var s=l(4134).hp;function i(){var e="<table>";let t=async e=>{try{let t=await e.xlsx.writeBuffer(),l=s.from(t).toString("base64");console.log("saving winner sheet");let a=await fetch("/api/save-pastwinners",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({workbookData:l})});if(!a.ok)throw Error("Failed to save file: ".concat(a.statusText));console.log("File saved successfully on the server.")}catch(e){console.error("Error saving file to server:",e)}},l=l=>{new(n()).Workbook().xlsx.load(l).then(async l=>{document.querySelector("table")||l.eachSheet(a=>{a.getSheetValues().slice(2).sort((e,t)=>{var l,a;return(null!=(l=t[4])?l:0)-(null!=(a=e[4])?a:0)}),!function(e,t){let l=!(arguments.length>2)||void 0===arguments[2]||arguments[2],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=arguments.length>4?arguments[4]:void 0;o=o||e.actualRowCount,t--;let r=[];for(let t=a;t<=(null!=o?o:e.actualRowCount);t++){let l=[];for(let a=1;a<=e.columnCount;a++)l.push(e.getRow(t).getCell(a).value);r.push(l)}r.sort((e,a)=>{var o,r,n,s;return e[t]===a[t]?0:l?(null!=(o=e[t])?o:0)>(null!=(r=a[t])?r:0)&&l?-1:1:(null!=(n=e[t])?n:0)<(null!=(s=a[t])?s:0)?-1:1}),e.spliceRows(a,o,...r)}(a,4,!0,2,a.rowCount),t(l),a.eachRow((t,l)=>{console.log("row values "+t.values),1===l?t.eachCell((t,l)=>{e+="<th>".concat(t.value,"</th>")}):(e+="<tr>",t.eachCell((t,a)=>{if(4===a){let l=JSON.stringify(t.value).split("T")[0].split('"')[1].split("-"),o=l[2]+"-"+l[1]+"-"+l[0];e+="<td id='date"+a+"'>".concat(o,"</td>")}else if(2===a)e+="<td id='score"+a+"'>".concat(t.value,"</td>");else if(3===a)if("object"==typeof t.value&&null!==t.value)for(let[a,o]of Object.entries(t.value))"text"===a&&(o.richText[0].text?e+="<td id='email"+l+"'>".concat(o.richText[0].text,"</td>"):e+="<td id='email"+l+"'>N/A</td>");else"string"==typeof t.value&&null!==t.value?e+="<td id='email"+l+"'>".concat(t.value,"</td>"):e+="<td id='email"+l+"'>N/A</td>";else e+="<td id='name"+a+"'>".concat(t.value,"</td>")})),e+="</tr>"});var o=document.getElementById("tableLeaderboard");o&&(o.innerHTML=e+"</table>")})}).catch(e=>{console.error("Error reading Excel file:",e)})},r=async()=>{try{console.log("loading winner sheet");let e=await fetch("data/pastwinners.xlsx");if(!e.ok)throw Error("Failed to fetch file: ".concat(e.statusText));let t=await e.arrayBuffer();l(t)}catch(e){console.error("Error loading file:",e)}};return(0,o.useEffect)(()=>{r()},[]),(0,a.jsxs)("main",{className:"flex min-h-screen flex-col items-start gap-4 px-24 py-10",children:[(0,a.jsx)("div",{className:"w-full h-20 text-white font-medium rounded-lg text-4xl px-5 py-2.5 text-left"}),(0,a.jsx)("div",{id:"tableLeaderboard"}),(0,a.jsx)("div",{className:"grid grid-cols-2"})]})}},2838:(e,t,l)=>{Promise.resolve().then(l.bind(l,1002))}},e=>{var t=t=>e(e.s=t);e.O(0,[904,343,134,441,684,358],()=>t(2838)),_N_E=e.O()}]);