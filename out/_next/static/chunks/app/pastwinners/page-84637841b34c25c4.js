(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[869],{201:(e,t,r)=>{Promise.resolve().then(r.bind(r,8982))},5215:()=>{},8982:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>c});var a=r(6384),l=r(6636),o=r(1685),n=r.n(o),s=r(2841),i=r.n(s);r(5215);var d=r(6754).hp;function c(){var e="<table>";let t=async e=>{try{let t=await e.xlsx.writeBuffer(),r=d.from(t).toString("base64"),a=await fetch("/api/save-pastwinners",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({workbookData:r})});if(!a.ok)throw Error("Failed to save file: ".concat(a.statusText));console.log("File saved successfully on the server.")}catch(e){console.error("Error saving file to server:",e)}},r=r=>{new(i()).Workbook().xlsx.load(r).then(async r=>{document.querySelector("table")||r.eachSheet(a=>{a.getSheetValues().slice(2).sort((e,t)=>{var r,a;return(null!=(r=t[4])?r:0)-(null!=(a=e[4])?a:0)}),!function(e,t){let r=!(arguments.length>2)||void 0===arguments[2]||arguments[2],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,l=arguments.length>4?arguments[4]:void 0;l=l||e.actualRowCount,t--;let o=[];for(let t=a;t<=(null!=l?l:e.actualRowCount);t++){let r=[];for(let a=1;a<=e.columnCount;a++)r.push(e.getRow(t).getCell(a).value);o.push(r)}o.sort((e,a)=>{var l,o,n,s;return e[t]===a[t]?0:r?(null!=(l=e[t])?l:0)>(null!=(o=a[t])?o:0)&&r?-1:1:(null!=(n=e[t])?n:0)<(null!=(s=a[t])?s:0)?-1:1}),e.spliceRows(a,l,...o)}(a,4,!0,2,a.rowCount),t(r),a.eachRow((t,r)=>{console.log("row values "+t.values),1===r?t.eachCell((t,r)=>{e+="<th>".concat(t.value,"</th>")}):(e+="<tr>",t.eachCell((t,a)=>{if(4===a){let r=JSON.stringify(t.value).split("T")[0].split('"')[1].split("-"),l=r[2]+"-"+r[1]+"-"+r[0];e+="<td id='date"+a+"'>".concat(l,"</td>")}else if(2===a)e+="<td id='score"+a+"'>".concat(t.value,"</td>");else if(3===a)if("object"==typeof t.value&&null!==t.value)for(let[a,l]of Object.entries(t.value))"text"===a&&(l.richText[0].text?e+="<td id='email"+r+"'>".concat(l.richText[0].text,"</td>"):e+="<td id='email"+r+"'>N/A</td>");else"string"==typeof t.value&&null!==t.value?e+="<td id='email"+r+"'>".concat(t.value,"</td>"):e+="<td id='email"+r+"'>N/A</td>";else e+="<td id='name"+a+"'>".concat(t.value,"</td>")})),e+="</tr>"});var l=document.getElementById("tableLeaderboard");l&&(l.innerHTML=e+"</table>")})}).catch(e=>{console.error("Error reading Excel file:",e)})},o=async()=>{try{let e=await fetch("data/pastwinners.xlsx");if(!e.ok)throw Error("Failed to fetch file: ".concat(e.statusText));let t=await e.arrayBuffer();r(t)}catch(e){console.error("Error loading file:",e)}};return(0,l.useEffect)(()=>{o()},[]),(0,a.jsxs)("main",{className:"flex min-h-screen flex-col items-start gap-4 px-24 py-10",children:[(0,a.jsx)("div",{className:"w-full h-20 text-white font-medium rounded-lg text-4xl px-5 py-2.5 text-left"}),(0,a.jsx)("div",{id:"tableLeaderboard"}),(0,a.jsxs)("div",{className:"grid grid-cols-2",children:[(0,a.jsx)(n(),{href:"/",className:"text-gray-900 bg-white border border-gray-300 focus:outline-none hover:bg-gray-100 focus:ring-4 focus:ring-gray-200 font-medium rounded-lg text-sm px-5 py-2.5 dark:bg-gray-800 dark:text-white dark:border-gray-600 dark:hover:bg-gray-700 dark:hover:border-gray-600 dark:focus:ring-gray-700",children:"Home"}),(0,a.jsx)(n(),{href:"/leaderboard",className:"text-gray-900 bg-white border border-gray-300 focus:outline-none hover:bg-gray-100 focus:ring-4 focus:ring-gray-200 font-medium rounded-lg text-sm px-5 py-2.5 dark:bg-gray-800 dark:text-white dark:border-gray-600 dark:hover:bg-gray-700 dark:hover:border-gray-600 dark:focus:ring-gray-700",children:"This Week's Leaderboard"})]})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[844,325,754,685,309,951,358],()=>t(201)),_N_E=e.O()}]);