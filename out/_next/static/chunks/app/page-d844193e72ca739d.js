(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{3570:(e,t,a)=>{Promise.resolve().then(a.bind(a,3757))},3757:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>B});var n=a(6384),r=function(e){return e[e.INNER_1=0]="INNER_1",e[e.TRP_1=1]="TRP_1",e[e.OUTER_1=2]="OUTER_1",e[e.DBL_1=3]="DBL_1",e[e.INNER_2=4]="INNER_2",e[e.TRP_2=5]="TRP_2",e[e.OUTER_2=6]="OUTER_2",e[e.DBL_2=7]="DBL_2",e[e.INNER_3=8]="INNER_3",e[e.TRP_3=9]="TRP_3",e[e.OUTER_3=10]="OUTER_3",e[e.DBL_3=11]="DBL_3",e[e.INNER_4=12]="INNER_4",e[e.TRP_4=13]="TRP_4",e[e.OUTER_4=14]="OUTER_4",e[e.DBL_4=15]="DBL_4",e[e.INNER_5=16]="INNER_5",e[e.TRP_5=17]="TRP_5",e[e.OUTER_5=18]="OUTER_5",e[e.DBL_5=19]="DBL_5",e[e.INNER_6=20]="INNER_6",e[e.TRP_6=21]="TRP_6",e[e.OUTER_6=22]="OUTER_6",e[e.DBL_6=23]="DBL_6",e[e.INNER_7=24]="INNER_7",e[e.TRP_7=25]="TRP_7",e[e.OUTER_7=26]="OUTER_7",e[e.DBL_7=27]="DBL_7",e[e.INNER_8=28]="INNER_8",e[e.TRP_8=29]="TRP_8",e[e.OUTER_8=30]="OUTER_8",e[e.DBL_8=31]="DBL_8",e[e.INNER_9=32]="INNER_9",e[e.TRP_9=33]="TRP_9",e[e.OUTER_9=34]="OUTER_9",e[e.DBL_9=35]="DBL_9",e[e.INNER_10=36]="INNER_10",e[e.TRP_10=37]="TRP_10",e[e.OUTER_10=38]="OUTER_10",e[e.DBL_10=39]="DBL_10",e[e.INNER_11=40]="INNER_11",e[e.TRP_11=41]="TRP_11",e[e.OUTER_11=42]="OUTER_11",e[e.DBL_11=43]="DBL_11",e[e.INNER_12=44]="INNER_12",e[e.TRP_12=45]="TRP_12",e[e.OUTER_12=46]="OUTER_12",e[e.DBL_12=47]="DBL_12",e[e.INNER_13=48]="INNER_13",e[e.TRP_13=49]="TRP_13",e[e.OUTER_13=50]="OUTER_13",e[e.DBL_13=51]="DBL_13",e[e.INNER_14=52]="INNER_14",e[e.TRP_14=53]="TRP_14",e[e.OUTER_14=54]="OUTER_14",e[e.DBL_14=55]="DBL_14",e[e.INNER_15=56]="INNER_15",e[e.TRP_15=57]="TRP_15",e[e.OUTER_15=58]="OUTER_15",e[e.DBL_15=59]="DBL_15",e[e.INNER_16=60]="INNER_16",e[e.TRP_16=61]="TRP_16",e[e.OUTER_16=62]="OUTER_16",e[e.DBL_16=63]="DBL_16",e[e.INNER_17=64]="INNER_17",e[e.TRP_17=65]="TRP_17",e[e.OUTER_17=66]="OUTER_17",e[e.DBL_17=67]="DBL_17",e[e.INNER_18=68]="INNER_18",e[e.TRP_18=69]="TRP_18",e[e.OUTER_18=70]="OUTER_18",e[e.DBL_18=71]="DBL_18",e[e.INNER_19=72]="INNER_19",e[e.TRP_19=73]="TRP_19",e[e.OUTER_19=74]="OUTER_19",e[e.DBL_19=75]="DBL_19",e[e.INNER_20=76]="INNER_20",e[e.TRP_20=77]="TRP_20",e[e.OUTER_20=78]="OUTER_20",e[e.DBL_20=79]="DBL_20",e[e.BULL=80]="BULL",e[e.DBL_BULL=81]="DBL_BULL",e[e.MISS=82]="MISS",e[e.BUST=83]="BUST",e[e.RESET_BUTTON=84]="RESET_BUTTON",e}({});let o=(e,t)=>{switch(e){case 1:break;case 2:return t?"D":"Double";case 3:return t?"T":"Triple"}return""},l=e=>{if(e<80){let t=4;switch(e%4){case 1:t=3;break;case 3:t=2;break;default:t=1}let a=Math.ceil((e+1)/4),n=a*t,r=o(t,!1)+" "+a,l=o(t,!0)+a;return console.log(e,t,a,n,r,l),{ID:e,Type:t,Section:a,Value:n,LongName:r,ShortName:l}}switch(e){case 80:case 81:let t=80===e?1:2,a=o(t,!1)+" Bullseye",n=o(t,!0)+"BULL";return{ID:e,Type:t,Section:25,Value:80===e?25:50,LongName:a,ShortName:n};case 84:return{ID:e,Type:4,Section:26,Value:0,LongName:"Reset Button",ShortName:"RST"};case 83:return{ID:e,Type:4,Section:26,Value:0,LongName:"Bust",ShortName:"Bust"};default:return{ID:e,Type:4,Section:26,Value:0,LongName:"Miss",ShortName:"Miss"}}};var i=a(6636),s=a(2841),c=a.n(s),_=a(3275),d=a.n(_),u=a(6754).hp;let R="442f1570-8a00-9a28-cbe1-e1d4212d53eb",E=1,T=0,h={"50-46-51-64":r.INNER_1,"50-46-52-64":r.TRP_1,"50-46-53-64":r.OUTER_1,"50-46-54-64":r.DBL_1,"57-46-49-64":r.INNER_2,"57-46-48-64":r.TRP_2,"57-46-50-64":r.OUTER_2,"56-46-50-64":r.DBL_2,"55-46-49-64":r.INNER_3,"55-46-48-64":r.TRP_3,"55-46-50-64":r.OUTER_3,"56-46-52-64":r.DBL_3,"48-46-49-64":r.INNER_4,"48-46-51-64":r.TRP_4,"48-46-53-64":r.OUTER_4,"48-46-54-64":r.DBL_4,"53-46-49-64":r.INNER_5,"53-46-50-64":r.TRP_5,"53-46-52-64":r.OUTER_5,"52-46-54-64":r.DBL_5,"49-46-48-64":r.INNER_6,"49-46-49-64":r.TRP_6,"49-46-51-64":r.OUTER_6,"52-46-52-64":r.DBL_6,"49-49-46-49-64":r.INNER_7,"49-49-46-50-64":r.TRP_7,"49-49-46-52-64":r.OUTER_7,"56-46-54-64":r.DBL_7,"54-46-50-64":r.INNER_8,"54-46-52-64":r.TRP_8,"54-46-53-64":r.OUTER_8,"54-46-54-64":r.DBL_8,"57-46-51-64":r.INNER_9,"57-46-52-64":r.TRP_9,"57-46-53-64":r.OUTER_9,"57-46-54-64":r.DBL_9,"50-46-48-64":r.INNER_10,"50-46-49-64":r.TRP_10,"50-46-50-64":r.OUTER_10,"52-46-51-64":r.DBL_10,"55-46-51-64":r.INNER_11,"55-46-52-64":r.TRP_11,"55-46-53-64":r.OUTER_11,"55-46-54-64":r.DBL_11,"53-46-48-64":r.INNER_12,"53-46-51-64":r.TRP_12,"53-46-53-64":r.OUTER_12,"53-46-54-64":r.DBL_12,"48-46-48-64":r.INNER_13,"48-46-50-64":r.TRP_13,"48-46-52-64":r.OUTER_13,"52-46-53-64":r.DBL_13,"49-48-46-51-64":r.INNER_14,"49-48-46-52-64":r.TRP_14,"49-48-46-53-64":r.OUTER_14,"49-48-46-54-64":r.DBL_14,"51-46-48-64":r.INNER_15,"51-46-49-64":r.TRP_15,"51-46-50-64":r.OUTER_15,"52-46-50-64":r.DBL_15,"49-49-46-48-64":r.INNER_16,"49-49-46-51-64":r.TRP_16,"49-49-46-53-64":r.OUTER_16,"49-49-46-54-64":r.DBL_16,"49-48-46-49-64":r.INNER_17,"49-48-46-48-64":r.TRP_17,"49-48-46-50-64":r.OUTER_17,"56-46-51-64":r.DBL_17,"49-46-50-64":r.INNER_18,"49-46-52-64":r.TRP_18,"49-46-53-64":r.OUTER_18,"49-46-54-64":r.DBL_18,"54-46-49-64":r.INNER_19,"54-46-48-64":r.TRP_19,"54-46-51-64":r.OUTER_19,"56-46-53-64":r.DBL_19,"51-46-51-64":r.INNER_20,"51-46-52-64":r.TRP_20,"51-46-53-64":r.OUTER_20,"51-46-54-64":r.DBL_20,"56-46-48-64":r.BULL,"52-46-48-64":r.DBL_BULL,"66-84-78-64":r.RESET_BUTTON,"79-85-84-64":r.MISS},N=async e=>{try{let t=await e.xlsx.writeBuffer(),a=u.from(t).toString("base64"),n=await fetch("/api/save-leaderboard",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({workbookData:a})});if(!n.ok)throw Error("Failed to save file: ".concat(n.statusText));console.log("File saved successfully on the server.")}catch(e){console.error("Error saving file to server:",e)}},m=(e,t)=>{new(c()).Workbook().xlsx.load(e).then(async e=>{e.eachSheet(e=>{e.addRow(t),console.log("addrow")})}).catch(e=>{console.error("Error reading Excel file:",e)})},p=async e=>{try{let t=await fetch("data/leaderboard.xlsx");if(!t.ok)throw Error("Failed to fetch file: ".concat(t.statusText));let a=await t.arrayBuffer();m(a,e)}catch(e){console.error("Error loading file:",e)}(0,i.useEffect)(()=>{p(e)},[])};class g{static async ConnectToBoard(){let e=await navigator.bluetooth.requestDevice({filters:[{services:[R]}]});if(await navigator.bluetooth,console.log("BLUETOOTH "+JSON.stringify(navigator.bluetooth)),!e||!e.gatt)throw Error("This PC's bluetooth could not find the board. Please make sure the board is connected.");e.gatt.connected||await e.gatt.connect();let t=await e.gatt.getPrimaryService(R),a=(await t.getCharacteristics()).find(e=>e.properties.notify);if(!a)throw Error("This PC's bluetooth could not find the board. Please make sure the board is connected.");let n=new g(a);return e.gatt.connect(),await a.startNotifications(),console.log(e.gatt.getPrimaryService(R)),n}async onSegmentHit(){if(E<7){if(!this.bluetoothConnection.value)return;let a=h[new Uint8Array(this.bluetoothConnection.value.buffer).join("-")];if(void 0!==a){a.toString(),null==(e=this.segmentHitCallback)||e.call(this,l(a)),E+=1;var e,t=l(a).Value;T+=t;let n=document.querySelector("dialog"),r=document.querySelector("#nameInput"),o=document.querySelector("#emailInput"),i=r?r.value:"",s=o?o.value:"",_="spanResult"+JSON.stringify(E),u=document.getElementById(_),R=document.getElementById("spanTotal");if(u&&(u.textContent=JSON.stringify(t)),R&&(R.textContent=JSON.stringify(T)),n?(n.querySelector("#nameSpan").textContent="Name: "+i,n.querySelector("#hitSpan").textContent="Last Hit: "+t,n.querySelector("#scoreSpan").textContent="Current Total Score: "+T,n.querySelector("#dartsSpan").textContent="Darts Remaining: "+(7-E)):console.log("Dialog element not found."),E>6){d().fire({title:"Out of Darts, "+i+"!",text:"Your score was: "+T+". \n\nThis has been added to the leaderboard. Want to play again?",icon:"warning",showConfirmButton:!0,showCancelButton:!0,confirmButtonText:"Yes",cancelButtonText:"No"}).then(e=>{e.isConfirmed?d().mixin({toast:!0,position:"center",iconColor:"green",customClass:{popup:"colored-toast"},showConfirmButton:!1,timer:2e3,timerProgressBar:!0}).fire({icon:"warning",title:"Get ready to throw!"}):d().fire({title:"Who's Playing?",html:'<input id="swal-input1" class="swal2-input" placeholder="Name"><input id="swal-input2" class="swal2-input" placeholder="Email (Optional)">',focusConfirm:!1,preConfirm:()=>{var e,t;return[(null==(e=document.getElementById("swal-input1"))?void 0:e.value)||"",(null==(t=document.getElementById("swal-input2"))?void 0:t.value)||""]}}).then(e=>{Array.from(document.getElementsByClassName("spanResult")).forEach(e=>{e.innerHTML=""});let t=document.getElementById("spanTotal");if(t&&(t.innerHTML=""),e.value){let t=document.getElementById("nameInput")||"",a=document.getElementById("emailInput")||"";t&&(t.innerHTML=e.value[0],t.placeholder=e.value[0]),a&&(a.innerHTML=e.value[1],a.placeholder=e.value[1])}})}),p([i,s,T,new Date().toLocaleDateString("en-GB")]);let e=await fetch("data/leaderboard.xlsx");if(!e.ok)throw Error("Failed to fetch file: ".concat(e.statusText));let t=await e.arrayBuffer();new(c()).Workbook().xlsx.load(t).then(async e=>{e.eachSheet(t=>{var a=!1,n=!1,r=!1,o=!1;t.eachRow((e,t)=>{e.eachCell((e,t)=>{1===t&&e.value===i&&(a=!0,console.log("NAME EXISTS")),2===t&&e.value===s&&(n=!0,console.log("EMAIL EXISTS")),3===t&&e.value===T&&(r=!0,console.log("SCORE EXISTS")),4===t&&e.value===new Date().toLocaleDateString("en-GB")&&(o=!0,console.log("DATE EXISTS"))})}),a&&n&&r&&o||(t.addRow([i,s,T,new Date().toLocaleDateString("en-GB")]),N(e)),T=0,E=1})}).catch(e=>{console.error("Error reading Excel file:",e)})}}}else E=1,T=0,d().fire({title:"Who's Playing?",html:'<input id="swal-input1" class="swal2-input" placeholder="Name"><input id="swal-input2" class="swal2-input" placeholder="Email (Optional)">',focusConfirm:!1,preConfirm:()=>{var e,t;return[(null==(e=document.getElementById("swal-input1"))?void 0:e.value)||"",(null==(t=document.getElementById("swal-input2"))?void 0:t.value)||""]}}).then(e=>{Array.from(document.getElementsByClassName("spanResult")).forEach(e=>{e.innerHTML=""});let t=document.getElementById("spanTotal");if(t&&(t.innerHTML=""),e.value){let t=document.getElementById("nameInput")||"",a=document.getElementById("emailInput")||"";t&&(t.innerHTML=e.value[0],t.placeholder=e.value[0]),a&&(a.innerHTML=e.value[1],a.placeholder=e.value[1])}})}constructor(e){this.bluetoothConnection=e,this.bluetoothConnection.addEventListener("characteristicvaluechanged",this.onSegmentHit.bind(this))}}a(5215);let f=e=>{new(c()).Workbook().xlsx.load(e).then(e=>{e.eachSheet((e,t)=>{e.eachRow((e,t)=>{})})}).catch(e=>{console.error("Error reading Excel file:",e)})};function B(){let[e,t]=(0,i.useState)(),[a,r]=(0,i.useState)("Click Here To Connect"),o=async()=>{r("Connecting...");try{t(await g.ConnectToBoard()),r("Connected"),console.log(g)}catch(e){console.error(e),r("Error - please click to retry.")}},l=async()=>{try{let e=await fetch("data/leaderboard.xlsx");if(!e.ok)throw Error("Failed to fetch file: ".concat(e.statusText));let t=await e.arrayBuffer();f(t)}catch(e){console.error("Error loading file:",e)}},s=(0,i.useRef)(null);return(0,i.useEffect)(()=>{d().mixin({toast:!0,position:"center",iconColor:"green",customClass:{popup:"colored-toast"},showConfirmButton:!1,timer:2e3,timerProgressBar:!0}).fire({icon:"warning",title:"Get ready to throw!"}),d().fire({title:"Who's Playing?",html:'<input id="swal-input1" class="swal2-input" placeholder="Name"><input id="swal-input2" class="swal2-input" placeholder="Email (Optional)">',focusConfirm:!1,preConfirm:()=>{var e,t;return[(null==(e=document.getElementById("swal-input1"))?void 0:e.value)||"",(null==(t=document.getElementById("swal-input2"))?void 0:t.value)||""]}}).then(e=>{if(e.value){console.log("Result: "+e.value);let t=document.getElementById("nameInput")||"",a=document.getElementById("emailInput")||"";t&&(t.innerHTML=e.value[0],t.placeholder=e.value[0]),a&&(a.innerHTML=e.value[1],a.placeholder=e.value[1])}});let e=s.current;if(!e)return;let t=e.getContext("2d");if(t)for(let e=0;e<20;e++){let a=.05*Math.PI+.1*e*Math.PI,n=a+.1*Math.PI,r="#ffffff",o="#ffb914";t.lineWidth=2,t.strokeStyle="white",t.fillStyle=e%2==0?r:o,t.beginPath(),t.moveTo(250,250),t.arc(250,250,240,a,n,!1),t.closePath(),t.fill(),t.stroke(),t.fillStyle=e%2==0?"#000000":"#FFFFFF",t.beginPath(),t.moveTo(250,250),t.arc(250,250,220,a,n,!1),t.closePath(),t.fill(),t.stroke(),t.fillStyle=e%2==0?r:o,t.beginPath(),t.moveTo(250,250),t.arc(250,250,140,a,n,!1),t.closePath(),t.fill(),t.stroke(),t.fillStyle=e%2==0?"#000000":"#FFFFFF",t.beginPath(),t.moveTo(250,250),t.arc(250,250,120,a,n,!1),t.closePath(),t.fill(),t.stroke(),t.fillStyle=r,t.beginPath(),t.arc(250,250,30,0,2*Math.PI,!1),t.fill(),t.stroke(),t.fillStyle="#e62236",t.beginPath(),t.arc(250,250,10,0,2*Math.PI,!1),t.fill(),t.stroke()}},[]),(0,i.useEffect)(()=>{l()},[]),(0,n.jsxs)("main",{children:[(0,n.jsxs)("dialog",{style:{position:"absolute",top:0,right:0,marginRight:"1em",marginTop:"1em",padding:"1em",border:"none",backgroundColor:"transparent",color:"black",fontSize:"1.8em",textAlign:"right",fontFamily:"monospace"},children:[(0,n.jsx)("span",{className:"animate__animated animate__bounce",id:"nameSpan",children:"Name: "}),(0,n.jsx)("br",{}),(0,n.jsx)("span",{className:"animate__animated animate__bounce",id:"hitSpan",children:"Last Hit: "}),(0,n.jsx)("br",{}),(0,n.jsx)("span",{className:"animate__animated animate__bounce",id:"scoreSpan",children:"Current Total Score: "}),(0,n.jsx)("br",{}),(0,n.jsx)("span",{className:"animate__animated animate__bounce",id:"dartsSpan",children:"Remaining Darts: "})]}),(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsxs)("div",{className:"inputsDiv flex flex-row",children:[(0,n.jsx)("span",{id:"blackboxName"}),(0,n.jsx)("span",{id:"blackboxEmail"}),(0,n.jsx)("input",{id:"nameInput",type:"text",className:"content-name text-gray-900 bg-white border border-gray-300 focus:outline-none hover:bg-gray-100 focus:ring-4 focus:ring-gray-200 font-medium rounded-lg text-sm px-5 py-2.5 dark:bg-gray-800 dark:text-white dark:border-gray-600 dark:hover:bg-gray-700 dark:hover:border-gray-600 dark:focus:ring-gray-700",placeholder:"Name"}),(0,n.jsx)("input",{id:"emailInput",type:"text",className:"content-name text-gray-900 bg-white border border-gray-300 focus:outline-none hover:bg-gray-100 focus:ring-4 focus:ring-gray-200 font-medium rounded-lg text-sm px-5 py-2.5 dark:bg-gray-800 dark:text-white dark:border-gray-600 dark:hover:bg-gray-700 dark:hover:border-gray-600 dark:focus:ring-gray-700",placeholder:"Email"})]}),(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{id:"blackboxHit1",children:[(0,n.jsx)("span",{className:"spanHit",children:"Hit 1: "}),(0,n.jsx)("span",{className:"spanResult",id:"spanResult1",children:" "})]}),(0,n.jsxs)("div",{id:"blackboxHit2",children:[(0,n.jsx)("span",{className:"spanHit",children:"Hit 2: "}),(0,n.jsx)("span",{className:"spanResult spanResult2",id:"spanResult2",children:" "})]}),(0,n.jsxs)("div",{id:"blackboxHit3",children:[(0,n.jsx)("span",{className:"spanHit",children:"Hit 3: "}),(0,n.jsx)("span",{className:"spanResult spanResult3",id:"spanResult3",children:" "})]}),(0,n.jsxs)("div",{id:"blackboxHit4",children:[(0,n.jsx)("span",{className:"spanHit",children:"Hit 4: "}),(0,n.jsx)("span",{className:"spanResult spanResult4",id:"spanResult4",children:" "})]}),(0,n.jsxs)("div",{id:"blackboxHit5",children:[(0,n.jsx)("span",{className:"spanHit",children:"Hit 5: "}),(0,n.jsx)("span",{className:"spanResult spanResult5",id:"spanResult5",children:" "})]}),(0,n.jsxs)("div",{id:"blackboxHit6",children:[(0,n.jsx)("span",{className:"spanHit",children:"Hit 6: "}),(0,n.jsx)("span",{className:"spanResult spanResult6",id:"spanResult6",children:" "})]}),(0,n.jsxs)("div",{id:"totalBox",children:[(0,n.jsx)("span",{id:"titleTotal",children:"Total"}),(0,n.jsx)("span",{id:"spanTotal",children:"250"})]})]}),(0,n.jsx)("canvas",{className:"canvasdb",ref:s,width:500,height:500}),(0,n.jsx)("div",{className:"items-center",children:(0,n.jsx)("button",{className:"connectButton text-gray-900 bg-white border border-gray-300 focus:outline-none hover:bg-gray-100 focus:ring-4 focus:ring-gray-200 font-medium rounded-lg text-sm px-5 py-2.5 dark:bg-gray-800 dark:text-white dark:border-gray-600 dark:hover:bg-gray-700 dark:hover:border-gray-600 dark:focus:ring-gray-700",onClick:o,children:a})})]})]})}},5215:()=>{}},e=>{var t=t=>e(e.s=t);e.O(0,[844,325,985,754,309,951,358],()=>t(3570)),_N_E=e.O()}]);