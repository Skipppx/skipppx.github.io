(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[410],{4817:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>d});var r=a(6384),o=a(6636),l=a(1685),s=a.n(l),n=a(2841),c=a.n(n),i=a(6754).hp;function d(){var e="<table><th>Position</th>",t=1;let a=new(c()).Workbook,l=new(c()).Workbook,n=async e=>{try{let t=await e.xlsx.writeBuffer(),a=i.from(t).toString("base64"),r=await fetch("/api/save-leaderboard",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({workbookData:a})});if(!r.ok)throw Error("Failed to save file: ".concat(r.statusText));console.log("File saved successfully on the server.")}catch(e){console.error("Error saving file to server:",e)}},d=async e=>{try{let t=await e.xlsx.writeBuffer(),a=i.from(t).toString("base64"),r=await fetch("/api/save-leaderboard",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({workbookData:a})});if(!r.ok)throw Error("Failed to save file: ".concat(r.statusText));console.log("File saved successfully on the server.")}catch(e){console.error("Error saving file to server:",e)}},f=e=>{l.xlsx.load(e).then(async e=>{var t,r=new Date;e.eachSheet(o=>{o.eachRow(async(l,s)=>{if(2===s){let s=l.getCell(4).value;if(t=s instanceof Date?s:void 0){if(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Date;return t.setDate(t.getDate()+7*e),t}(1,t)<=r){let t=await fetch("data/leaderboard.xlsx");if(!t.ok)throw Error("Failed to fetch file: ".concat(t.statusText));let l=await t.arrayBuffer();a.xlsx.load(l).then(async t=>{var a,l,s;t.eachSheet(async c=>{c.eachRow((e,t)=>{2===t&&e.eachCell((e,t)=>{if(1===t&&(a="string"==typeof e.value?e.value:""),2===t)if("object"==typeof e.value&&null!==e.value)for(let[t,a]of Object.entries(e.value))"text"===t&&(l=a.richText[0].text);else"string"==typeof e.value&&null!==e.value&&(l=e.value);3===t&&(s="number"==typeof e.value?e.value:0)})});var i=[a,s,l,r];a&&l&&s&&o.spliceRows(2,0,i),d(e),await c.eachRow((e,a)=>{c.getSheetValues().slice(1),c.eachRow((e,t)=>{1!==t&&c.spliceRows(2,t)}),n(t)})})})}}else console.log("Invalid oldDate, cannot add weeks")}})})})},u=r=>{a.xlsx.load(r).then(async a=>{document.querySelector("table")||a.eachSheet(r=>{!function(e,t){let a=!(arguments.length>2)||void 0===arguments[2]||arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=arguments.length>4?arguments[4]:void 0;o=o||e.actualRowCount,t--;let l=[];for(let t=r;t<=(null!=o?o:e.actualRowCount);t++){let a=[];for(let r=1;r<=e.columnCount;r++)a.push(e.getRow(t).getCell(r).value);l.push(a)}l.sort((e,r)=>{var o,l,s,n;return e[t]===r[t]?0:a?(null!=(o=e[t])?o:0)>(null!=(l=r[t])?l:0)&&a?-1:1:(null!=(s=e[t])?s:0)<(null!=(n=r[t])?n:0)?-1:1}),e.spliceRows(r,o,...l)}(r,3,!0,2,r.rowCount),n(a),r.eachRow((a,r)=>{1===r?a.eachCell((t,a)=>{2!==a&&4!==a&&(e+="<th>".concat(t.value,"</th>"))}):(e+="<tr><td>"+t+"</td>",t++,a.eachCell((t,a)=>{4!==a&&(3===a?e+="<td id='score"+r+"'>".concat(t.value,"</td>"):2===a||(e+="<td id='name"+r+"'>".concat(t.value,"</td>")))})),e+="</tr>"});var o=document.getElementById("tableLeaderboard");o&&(o.innerHTML=e+"</table>")})}).catch(e=>{console.error("Error reading Excel file:",e)})},h=async()=>{try{let e=await fetch("data/leaderboard.xlsx");if(!e.ok)throw Error("Failed to fetch file: ".concat(e.statusText));let t=await e.arrayBuffer();u(t)}catch(e){console.error("Error loading file:",e)}};(0,o.useEffect)(()=>{h()},[]);let v=async()=>{try{let e=await fetch("data/pastwinners.xlsx");if(!e.ok)throw Error("Failed to fetch file: ".concat(e.statusText));let t=await e.arrayBuffer();f(t)}catch(e){console.error("Error loading file:",e)}};return(0,o.useEffect)(()=>{v()},[]),(0,r.jsxs)("main",{className:"flex min-h-screen flex-col items-start gap-4 px-24 py-10",children:[(0,r.jsx)("div",{className:"w-full h-20 text-white font-medium rounded-lg text-4xl px-5 py-2.5 text-left"}),(0,r.jsx)("div",{id:"tableLeaderboard"}),(0,r.jsx)("div",{className:"grid grid-cols-2",children:(0,r.jsx)(s(),{href:"/",className:"text-gray-900 bg-white border border-gray-300 focus:outline-none hover:bg-gray-100 focus:ring-4 focus:ring-gray-200 font-medium rounded-lg text-sm px-5 py-2.5 dark:bg-gray-800 dark:text-white dark:border-gray-600 dark:hover:bg-gray-700 dark:hover:border-gray-600 dark:focus:ring-gray-700",children:"Home"})})]})}},9436:(e,t,a)=>{Promise.resolve().then(a.bind(a,4817))}},e=>{var t=t=>e(e.s=t);e.O(0,[325,754,685,309,951,358],()=>t(9436)),_N_E=e.O()}]);