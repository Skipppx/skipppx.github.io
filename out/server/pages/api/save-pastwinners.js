"use strict";(()=>{var e={};e.id=999,e.ids=[999],e.modules={1983:(e,r,t)=>{t.r(r),t.d(r,{config:()=>P,default:()=>p,routeModule:()=>A});var n={};t.r(n),t.d(n,{default:()=>c});var s=t(33480),i=t(8667),a=t(86435),o=t(78608),u=t(33873),d=t.n(u),l=t(29021),f=t.n(l);async function c(e,r){if("POST"!==e.method)return r.status(405).json({error:"Method not allowed"});try{let{workbookData:t}=e.body,n=new o.Workbook;await n.xlsx.load(Buffer.from(t,"base64"));let s=d().join(process.cwd(),"public/data/pastwinners.xlsx");f().mkdirSync(d().dirname(s),{recursive:!0}),await n.xlsx.writeFile(s),r.status(200).json({message:"File saved successfully"})}catch(e){console.error("Error saving file:",e),r.status(500).json({error:"Failed to save file"})}}let p=(0,a.M)(n,"default"),P=(0,a.M)(n,"config"),A=new s.PagesAPIRouteModule({definition:{kind:i.A.PAGES_API,page:"/api/save-pastwinners",pathname:"/api/save-pastwinners",bundlePath:"",filename:""},userland:n})},8667:(e,r)=>{Object.defineProperty(r,"A",{enumerable:!0,get:function(){return t}});var t=function(e){return e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE",e.IMAGE="IMAGE",e}({})},29021:e=>{e.exports=require("fs")},33480:(e,r,t)=>{e.exports=t(75600)},33873:e=>{e.exports=require("path")},75600:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},78608:e=>{e.exports=require("exceljs")},86435:(e,r)=>{Object.defineProperty(r,"M",{enumerable:!0,get:function(){return function e(r,t){return t in r?r[t]:"then"in r&&"function"==typeof r.then?r.then(r=>e(r,t)):"function"==typeof r&&"default"===t?r:void 0}}})}};var r=require("../../webpack-api-runtime.js");r.C(e);var t=r(r.s=1983);module.exports=t})();